
---

## ðŸ”„ ANTLR íŒŒì‹± ìŠ¤íŠ¸ë¦¼ ìŠ¤íŽ™

### ê°œìš”

ANTLR ì„œë²„ì˜ `/antlr/parsing` ì—”ë“œí¬ì¸íŠ¸ë¥¼ NDJSON ìŠ¤íŠ¸ë¦¼ ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ íŒŒì‹± ì§„í–‰ ìƒí™©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.

### ìŠ¤íŠ¸ë¦¼ ë°©ì‹ ì„ íƒ ì´ìœ 

#### âŒ ëª¨ë“  êµ¬ë¬¸ë§ˆë‹¤ ë©”ì‹œì§€ ì „ì†¡ (ë¹„ì¶”ì²œ)

```
ë¬¸ì œì :
- 1,000ë¼ì¸ íŒŒì¼ â†’ ìˆ˜ë°±~ìˆ˜ì²œ ê°œì˜ ë©”ì‹œì§€ ë°œìƒ
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë²„í—¤ë“œ ì¦ê°€
- í”„ë¡ íŠ¸ì—”ë“œ ë Œë”ë§ ë¶€ë‹´
- ì‚¬ìš©ìžê°€ ë©”ì‹œì§€ë¥¼ ì½ì„ ìˆ˜ ì—†ì„ ì •ë„ë¡œ ë¹ ë¥´ê²Œ ì§€ë‚˜ê°
```

#### âœ… Në¼ì¸ ê°„ê²© ê¸°ì¤€ ë©”ì‹œì§€ ì „ì†¡ (ì±„íƒ)

```
ìž¥ì :
- 500ë¼ì¸ ê¸°ì¤€ â†’ 10,000ë¼ì¸ íŒŒì¼ë„ ì•½ 20ê°œ ë©”ì‹œì§€
- ì ì ˆí•œ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰
- ì‚¬ìš©ìžê°€ ì§„í–‰ ìƒí™©ì„ ì¸ì§€í•  ìˆ˜ ìžˆëŠ” ì†ë„
- ëª¨ë“  ì–¸ì–´(Java, PlSQL, PostgreSQL)ì— ê³µí†µ ì ìš© ê°€ëŠ¥
```

### ë°ì´í„° êµ¬ì¡° (NDJSON)

#### ê¸°ë³¸ í˜•ì‹

```typescript
interface StreamEvent {
  type: 'message' | 'error' | 'complete'
  content?: string      // ë©”ì‹œì§€ ë‚´ìš©
  errorType?: string    // ì—ëŸ¬ íƒ€ìž… (type: 'error'ì¼ ë•Œ)
  traceId?: string      // ì¶”ì  ID (ì—ëŸ¬ ì‹œ)
}
```

#### ìŠ¤íŠ¸ë¦¼ ì´ë²¤íŠ¸ ì¢…ë¥˜

| type | ì„¤ëª… | content ì˜ˆì‹œ |
|------|------|-------------|
| `message` | ì§„í–‰ ìƒí™© ë©”ì‹œì§€ | "UserService.java - 523ë¼ì¸ê¹Œì§€ íŒŒì‹± ì¤‘..." |
| `error` | ì—ëŸ¬ ë°œìƒ | "êµ¬ë¬¸ ì˜¤ë¥˜: ì˜ˆìƒì¹˜ ëª»í•œ í† í° (45ë¼ì¸)" |
| `complete` | íŒŒì‹± ì™„ë£Œ | - |

### ìŠ¤íŠ¸ë¦¼ íë¦„ ì˜ˆì‹œ

#### ì •ìƒ ì¼€ì´ìŠ¤

```json
{"type": "message", "content": "ðŸš€ íŒŒì‹±ì„ ì‹œìž‘í•©ë‹ˆë‹¤. (ì´ 3ê°œ íŒŒì¼)"}
{"type": "message", "content": "ðŸ“„ [1/3] UserService.java íŒŒì‹± ì‹œìž‘..."}
{"type": "message", "content": "ðŸ“ UserService.java - 523ë¼ì¸ê¹Œì§€ íŒŒì‹± ì¤‘..."}
{"type": "message", "content": "ðŸ“ UserService.java - 1047ë¼ì¸ê¹Œì§€ íŒŒì‹± ì¤‘..."}
{"type": "message", "content": "âœ… [1/3] UserService.java ì™„ë£Œ (1,234ë¼ì¸)"}
{"type": "message", "content": "ðŸ“„ [2/3] OrderController.java íŒŒì‹± ì‹œìž‘..."}
{"type": "message", "content": "ðŸ“ OrderController.java - 512ë¼ì¸ê¹Œì§€ íŒŒì‹± ì¤‘..."}
{"type": "message", "content": "âœ… [2/3] OrderController.java ì™„ë£Œ (756ë¼ì¸)"}
{"type": "message", "content": "ðŸ“„ [3/3] ProductRepository.java íŒŒì‹± ì‹œìž‘..."}
{"type": "message", "content": "âœ… [3/3] ProductRepository.java ì™„ë£Œ (234ë¼ì¸)"}
{"type": "message", "content": "ðŸŽ‰ íŒŒì‹± ì™„ë£Œ! ì´ 3ê°œ íŒŒì¼, 2,224ë¼ì¸ ì²˜ë¦¬ë¨"}
{"type": "complete"}
```

#### ì—ëŸ¬ ì¼€ì´ìŠ¤

```json
{"type": "message", "content": "ðŸš€ íŒŒì‹±ì„ ì‹œìž‘í•©ë‹ˆë‹¤. (ì´ 2ê°œ íŒŒì¼)"}
{"type": "message", "content": "ðŸ“„ [1/2] UserService.java íŒŒì‹± ì‹œìž‘..."}
{"type": "message", "content": "ðŸ“ UserService.java - 523ë¼ì¸ê¹Œì§€ íŒŒì‹± ì¤‘..."}
{"type": "error", "content": "âŒ UserService.java íŒŒì‹± ì‹¤íŒ¨: êµ¬ë¬¸ ì˜¤ë¥˜ (547ë¼ì¸)", "errorType": "SyntaxError"}
{"type": "message", "content": "ðŸ“„ [2/2] OrderController.java íŒŒì‹± ì‹œìž‘..."}
{"type": "message", "content": "âœ… [2/2] OrderController.java ì™„ë£Œ (756ë¼ì¸)"}
{"type": "message", "content": "âš ï¸ íŒŒì‹± ì™„ë£Œ (ì¼ë¶€ ì—ëŸ¬). ì„±ê³µ: 1ê°œ, ì‹¤íŒ¨: 1ê°œ"}
{"type": "complete"}
```

### ë¼ì¸ ì•Œë¦¼ ê¸°ì¤€

| ì„¤ì • | ê°’ | ì„¤ëª… |
|------|-----|------|
| `LINE_NOTIFY_INTERVAL` | 500 | 500ë¼ì¸ ê¸°ì¤€ ì´ˆê³¼ ì‹œ í˜„ìž¬ ë¼ì¸ ì•Œë¦¼ |

**ë™ìž‘ ë°©ì‹:**
- ì •í™•ížˆ 500ë¼ì¸ë§ˆë‹¤ê°€ ì•„ë‹˜
- 500ë¼ì¸ ê¸°ì¤€ì„ ë„˜ì€ ì‹œì ì˜ **ì‹¤ì œ ë¼ì¸ ë²ˆí˜¸**ë¥¼ ì „ì†¡
- ì˜ˆ: 0 â†’ 523ë¼ì¸ ì•Œë¦¼ â†’ 1047ë¼ì¸ ì•Œë¦¼ â†’ 1589ë¼ì¸ ì•Œë¦¼

```
êµ¬ë¬¸ ì§„ìž… ë¼ì¸   ì¡°ê±´ (lastLine + 500)   ì¶œë ¥
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
127ë¼ì¸         127 >= 0+500? âŒ        -
356ë¼ì¸         356 >= 0+500? âŒ        -
523ë¼ì¸         523 >= 0+500? âœ…        "523ë¼ì¸ê¹Œì§€ íŒŒì‹± ì¤‘..."
650ë¼ì¸         650 >= 523+500? âŒ      -
1047ë¼ì¸        1047 >= 523+500? âœ…     "1047ë¼ì¸ê¹Œì§€ íŒŒì‹± ì¤‘..."
```

### ì—”ë“œí¬ì¸íŠ¸ ìŠ¤íŽ™

#### Request

```
POST /antlr/parsing
Content-Type: application/json
Session-UUID: {ì„¸ì…˜ID}

{
  "target": "java",
  "projectName": "MyProject"
}
```

#### Response

```
Content-Type: application/x-ndjson
Transfer-Encoding: chunked

{"type": "message", "content": "..."}\n
{"type": "message", "content": "..."}\n
{"type": "complete"}\n
```

### êµ¬í˜„ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FileUploadController                          â”‚
â”‚  POST /antlr/parsing â†’ ResponseBodyEmitter (NDJSON ìŠ¤íŠ¸ë¦¼)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TargetParserStrategy                          â”‚
â”‚  parseWithStream(session, project, StreamCallback)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FileParserService                             â”‚
â”‚  parseProjectWithStream() - íŒŒì¼ ìˆœíšŒ + ì½œë°± í˜¸ì¶œ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CustomJavaListener (ë“±)                          â”‚
â”‚  enterEveryRule() - 500ë¼ì¸ ê°„ê²© ì²´í¬ â†’ ì½œë°± í˜¸ì¶œ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™

ê¸°ì¡´ `streamFetch()` í•¨ìˆ˜ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©:

```typescript
await antlrApi.parseStream(
  { target: 'java', projectName: 'MyProject' },
  sessionStore.getHeaders(),
  (event) => {
    if (event.content) {
      addParseMessage(event.type === 'error' ? 'error' : 'message', event.content)
    }
    if (event.type === 'complete') {
      // íŒŒì‹± ì™„ë£Œ ì²˜ë¦¬
    }
  }
)
```

